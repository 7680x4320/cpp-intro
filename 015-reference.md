# ポップカルチャーリファレンス

    ポップカルチャーリファレンスというのは流行の要素をさり気なく作品中に取り入れることで、流行作品を知っている読者の笑いを誘う手法である
    -- キャプテン・オブビウス ポップカルチャーリファレンスについて

変数に変数を代入すると、代入元の値が代入先にコピーされる。代入先の値を変更しても、コピーされた値が変わるだけで、代入元には一切影響がない。

~~~cpp
int main()
{
    int a = 1 ;
    int b = 2 ;

    b = a ;
    // b == 1

    b = 3 ;
    // a == 1
    // b == 3
}
~~~

これは関数も同じだ。

~~~cpp
void assign_3( int x )
{
    x = 3 ;
}

int main()
{
    int a = 1 ;
    assign_3( a ) ;

    // a == 1
}   
~~~

しかし、時には変数の値を直接書き換えたい場合がある。この時リファレンス(reference)が使える。リファレンスは変数に`&`を付けて宣言する

~~~cpp
int main()
{
    int a = 1 ;
    int & ref = a ;

    ref = 3 ;

    // a ==  3  
    // refはaなので同じく3
}
~~~

この例で、変数refは変数aへのリファレンスなので、変数aと同じように使える。

リファレンスは関数でも使える。

~~~cpp
void f( int & x )
{
    x = 3 ;
}

int main()
{
    int a = 1 ;
    f( a ) ;

    // a == 3
}
~~~


選択ソートで2つの変数の値を交換する必要があったことを覚えているだろうか。

~~~cpp
int main()
{
    std::vector<int> v = {3,2,1,4,5} ;

    // 0番目と2番目の要素を交換したい
    auto temp = v.at(0) ;
    v.at(0) = v.at(2) ;
    v.at(2) = temp ;
}
~~~

いちいち交換のために別の変数`temp`を作って3回代入を書くのは面倒だ。これを関数にしてしまいたい。

~~~
// 値を交換
swap( v.at(0), v.at(2) ) ;
~~~

このような関数`swap`は普通に書くことはできない。

~~~cpp
// この実装は正しくない
auto swap = []( auto a, auto b )
{
    auto temp = a ;
    a = b ;
    b = temp ;
} ;
~~~


この実装では、変数は単にコピーされるだけなので、関数の呼び出し元には何の影響もない。

これをリファレンスに変えると、関数の呼び出し元の変数の値を交換する関数`swap`が作れる。


~~~cpp
// リファレンス
auto swap = []( auto & a, auto & b )
{
    auto temp = a ;
    a = b ;
    b = temp ;
} ;
~~~

C++の標準ライブラリには`std::swap`があるので、読者はわざわざこのような関数を自作する必要はない。

~~~cpp
int main()
{
    int a = 1 ;
    int b = 2 ;

    std::swap( a, b ) ;

    // a == 2
    // b == 1
}
~~~
